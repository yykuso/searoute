export function showContextMenu(t,e,n){const o=document.getElementById("context-menu");if(!o)return;let i=null,c=null;if(n&&"function"==typeof n.unproject){const o=n.unproject([t,e]);i=o.lat,c=o.lng}o.style.left=t+"px",o.style.top=e+"px",o.style.display="block";const d=document.getElementById("context-copy-btn");d.textContent=i&&c?`${i.toFixed(5)},${c.toFixed(5)}`:"座標",d.style.whiteSpace="nowrap",d.replaceWith(d.cloneNode(!0));document.getElementById("context-copy-btn").addEventListener("click",t=>{t.stopPropagation(),i&&c&&navigator.clipboard.writeText(`${i.toFixed(5)},${c.toFixed(5)}`).then(()=>alert("座標がコピーされました")).catch(()=>{alert("座標のコピーに失敗しました")}),hideContextMenu()});const l=document.getElementById("context-gmap-btn");l.replaceWith(l.cloneNode(!0));document.getElementById("context-gmap-btn").addEventListener("click",t=>{if(t.stopPropagation(),null!=i&&null!=c){const t=`https://www.google.com/maps?q=${i},${c}`;window.open(t,"_blank","noopener,noreferrer")}hideContextMenu()});const r=o.getBoundingClientRect();r.right>window.innerWidth&&(o.style.left=window.innerWidth-r.width-8+"px"),r.bottom>window.innerHeight&&(o.style.top=window.innerHeight-r.height-8+"px"),setTimeout(()=>{function t(e){const n=document.getElementById("context-menu");n&&(n.contains(e.target)||(hideContextMenu(),document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)))}document.addEventListener("mousedown",t),document.addEventListener("touchstart",t)},0)}export function hideContextMenu(){const t=document.getElementById("context-menu");t&&(t.style.display="none")}